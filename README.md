# DIT acts
## Описание
Проект разработан для автоматического создания, изменения и анализа документов `.xlsx`,  создания и анализа документов `.docx`. Данный проект позволяет свести ошибки к минимуму, сократить время создания с 5 дней 3-х человек, до 1 часа 1-го человека.

### Использование
***Примечание:*** 

 1. Все файлы с расширением `.csv` должны иметь кодировку `ANSI`
    (используется в MS Excel).
 2. Для удобства использования запускайте файл проекта `main.py`, но возможен запуск каждого модуля в отдельности.

**Создание титульных листов  с расширением .docx (title_page.py)**

Создайте папку для работы утилиты. Запустите из корня проекта команду в терминале:
```
mkdir Данные_для_актов
```
В созданную директорию необходимо положить `word_data_{номер очереди}.csv`

*Необходимые заголовки:*
 - num;
 - contract;
 - kod;
 - period;
 - date;
 - post;
 - executor;
 - attorney;
 - title;
 - short;
 - position;
 - client;
 - regulation;
 
Выполните скрипт. После завершения работы скрипта откроется директория `Титульные_листы_{номер очереди}-я_очередь` с созданными файлами.

**Анализ титульных листов  с расширением .docx (analysis_title_page.py)**

Создайте папку для работы утилиты. Запустите из корня проекта команду в терминале:
```
mkdir -p Данные_из_титульных_листов/{1-я,4-я,5-я,13-я}
```
Положите файлы формата `.docx` в нужную очередь (1, 4, 5 или 13):
Выполните скрипт. После завершения работы скрипта откроется директория `Данные_из_титульных_листов`. Данные собираются в файл `Данные по {номер очереди}-ой очереди.csv`.

**Создание документов с расширением .xlsx (acts.py)**

Создайте папку для работы утилиты. Запустите из корня проекта команду в терминале:
```
mkdir Данные_для_актов
```
В созданную директорию необходимо положить `excel_data_{номер очереди}.csv`

*Необходимые заголовки:*
 - ТТ;
 - Тип;
 - Наименование МО;
 - Адрес;
 - н1;
 - к1;
 - н2;
 - к2;
 - н3;
 - к3;
 - Подпись;
 - Общее МО.
 
*Примечание:* н - начало n-го месяца, к - конец n-го месяца), ТТ - технологическая точка.
		
**Внесение инцидентов в файлы с расширением .xlsx  (incidents.py)**

Создайте папку для работы утилиты. Запустите из корня проекта команду в терминале:
```
mkdir Данные_для_актов &&
mkdir -p Акты_с_заявками/input/{1-я,4-я,5-я,13-я} &&
mkdir -p Акты_с_заявками/output/{1-я,4-я,5-я,13-я}
```
В созданную директорию необходимо положить `incident_{номер очереди}.csv`.

*Необходимые заголовки:*
 - МО;
 - ТТ;
 - Номер заявки;
 - Время в отложено;
 - Время обработки;
 - Время назначения;
 - Время закрытия;
 - Время ограничения;
 - Коэффициент;
 
 *Примечание:* МО - медицинская организация, ТТ - технологическая точка.
 Выполните скрипт. После завершения работы скрипта откроется директория с обработанными файлами `Акты_с_заявками`.
 
**Анализ документов  с расширением .xlsx (analysis_acts.py)**

 Создайте папку для работы утилиты. Запустите из корня проекта команду в терминале:
 ```
 mkdir -p Анализ_актов/input/{1-я,4-я,5-я,13-я}
 ```
Положите файлы формата `.xlsx` в нужную очередь (1, 4, 5 или 13):
Выполните скрипт. После завершения работы скрипта откроется директория `Анализ_актов`. Данные собираются в файл `Данные (СП{номер очереди}).csv`.

### Установка

 1. Клонируйте репозиторий на свой компьютер
2.  Создайте и активируйте виртуальное окружение, установите зависимостей из файла  _requirements.txt_.
```
python -m venv venv
```
```
python -m pip install --upgrade pip
```
```
venv/Scripts/activate
```
```
pip install -r requirements.txt
```
Запустите навигатор `main.py` или интересующий модуль отдельно.

### Технологии
 - Python 3.9
 - Python-docx
 - Openpyxl
 
### Автор
[Shubenkov Aleksey](https://github.com/In-Quatro)
